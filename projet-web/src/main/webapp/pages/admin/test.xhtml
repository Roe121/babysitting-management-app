<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition template="/template/page-standard.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets">

    <f:metadata>
        <f:viewAction action="#{ChartBean.init}" />
    </f:metadata>

    <ui:define name="titre">Statistiques avec Google Charts</ui:define>

    <ui:define name="contenu">
        
        <!-- Div qui contiendra le graphique -->
        <div id="chart_div" style="width: 900px; height: 500px;"></div>

        <h:outputScript target="body">
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                // Les données du graphique provenant du Managed Bean JSF
                var data = google.visualization.arrayToDataTable([
                    ['Jour', 'Montant (€)'],
                    <h:outputText value="#{ChartBean.chartDataJS}" escape="false"/>
                ]);

                var options = {
                    title: 'Montants à payer par jour',
                    hAxis: {title: 'Jour',  titleTextStyle: {color: '#333'}},
                    vAxis: {minValue: 0}
                };

                var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            }
        </h:outputScript>

    </ui:define>
</ui:composition>
